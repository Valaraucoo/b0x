{% extends "base.html" %}
{% load i18n %}

{% block title %}Dashboard{% endblock %}

{% block content %}
    <div id="bucket" class="container mt-24 mx-auto px-4">
        {% if request.user.is_authenticated %}
            <a class="mt-3 transform duration-200 focus:outline-none w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:w-auto sm:text-sm hover:bg-gray-200" href="{% url 'buckets:dashboard' %}">{% trans 'Go to dashboard' %}</a>
        {% endif %}
        {% if request.user == bucket.user %}
            <a class="mt-3 sm:ml-1 transform duration-200 focus:outline-none w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:w-auto sm:text-sm hover:bg-gray-200" href="{% url 'buckets:dashboard' %}">{% trans 'Edit' %}</a>
            <button @click="isOpen = true;" class="mt-3 sm:ml-1 transform duration-200 focus:outline-none w-full inline-flex justify-center rounded-md border border-pink-400 shadow-sm px-4 py-2 bg-pink-300 text-base font-medium text-white hover:bg-pink-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:w-auto sm:text-sm hover:bg-pink-400" href="{% url 'buckets:dashboard' %}">{% trans 'Add file' %}</button>
        {% endif %}
        <div v-if="isOpen">
            {% include 'components/buckets/add_file_modal.html' %}
        </div>
        {% include 'components/buckets/stats.html' %}
        {% include 'components/buckets/file-list.html' %}
    </div>
{% endblock %}

{% block extrascripts %}
  <script type="application/javascript">
    var app = new Vue({
      delimiters: ['[[', ']]'],
      el: '#bucket',
      data: {
          isOpen: false,
          isHovered: false,
          isDisabled: true,
          file: null,
      },
      computed: {
      },
      created: function() {},
      beforeMount: function () {
          this.isOpen = false;
      },
      methods: {
          uploadFile(e) {
            this.file = e.target.files[0];
            this.isDisabled = false;
          },
          addFile(e) {
              this.file = e.dataTransfer.files[0];
              this.isDisabled = false;
          },
          dragHover() {
              this.isHovered = true;
          },
          removefile() {
              this.file = null;
              this.isDisabled = true;
          },
          openImage(url, height, width, filename) {
              Swal.fire({
                  title: filename,
                  imageUrl: url,
                  imageWidth: width,
                  imageHeight: Math.min(height, 300),
                  imageAlt: filename,
                })
          }
      }
    });
  </script>
{% endblock extrascripts %}